tosca_definitions_version: tosca_simple_yaml_1_3
description: Example of an architecture distributed across several geographical locations.
imports:
    - types.yaml

topology_template:
    node_templates:


        ###################################################
        #
        # Cloud
        #
        ###################################################

        cloud_service:
            type: example.nodes.Cloud.Service
            requirements:
                -   host: cloud_provider

        cloud_provider:
            type: example.nodes.Cloud.Provider


        ###################################################
        #
        # Location A
        #
        ###################################################

        location_a_ecu_software:
            type: example.nodes.ECU.Software
            requirements:
                -   host: location_a_ecu_runtime
                -   ecu: location_b_ecu_software

        location_a_ecu_runtime:
            type: example.nodes.ECU.Runtime
            requirements:
                -   host: location_a_ecu_hardware

        location_a_ecu_hardware:
            type: example.nodes.ECU.Hardware
            requirements:
                -   can: location_a_can_bus

        location_a_can_bus:
            type: sofdcar.nodes.CAN

        location_a_can_bridge:
            type: example.nodes.CAN.Bridge
            requirements:
                -   can: location_a_can_bus
                -   cloud: cloud_service

        ###################################################
        #
        # Location B
        #
        ###################################################

        location_b_ecu_software:
            type: example.nodes.ECU.Software
            requirements:
                -   host: location_b_ecu_runtime

        location_b_ecu_runtime:
            type: example.nodes.ECU.Runtime
            requirements:
                -   host: location_b_ecu_hardware

        location_b_ecu_hardware:
            type: example.nodes.ECU.Hardware
            requirements:
                -   can: location_b_can_bus

        location_b_can_bus:
            type: sofdcar.nodes.CAN

        location_b_can_bridge:
            type: example.nodes.CAN.Bridge
            requirements:
                -   can: location_b_can_bus
                -   cloud: cloud_service

    groups:
        cloud:
            type: sofdcar.groups.Location
            members:
                - cloud_service
                - cloud_provider

        location_a:
            type: sofdcar.groups.Location
            members:
                - location_a_ecu_software
                - location_a_ecu_runtime
                - location_a_ecu_hardware
                - location_a_can_bus
                - location_a_can_bridge

        location_b:
            type: sofdcar.groups.Location
            members:
                - location_b_ecu_software
                - location_b_ecu_runtime
                - location_b_ecu_hardware
                - location_b_can_bus
                - location_b_can_bridge
