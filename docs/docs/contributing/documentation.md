---
tags:
- Contributing
---

# Documentation

This document holds instructions on writing the documentation.

## Guidelines

We follow the following guidelines when writing documentation.

- start a document with "This document holds ..."
- use "we" instead of "you" or imperative
- use "Next, we" instead of "Then, we ...", "We then ...", etc.
- use ", see" instead of "..., as given in ...", "..., as presented in ...", etc.
- use the step-by-step guide template in `docs/templates/guide`
- use the specification template in `docs/templates/specification`
- use "as follows" instead of "in the following"


## MkDocs

{{ linux_only_notice() }}

We use [Material for MkDocs](https://squidfunk.github.io/mkdocs-material){target=_blank} as documentation system.
The files are located in the `docs` directory.
Custom macros are implemented in `docs/macros.py` using [mkdocs-macros](https://mkdocs-macros-plugin.readthedocs.io){target=_blank}.

First, install all dependencies. 
This will install several apt packages on the system and mkdocs in a virtual environment.

```shell linenums="1"
./task docs:install
```

Next, reload your session.

Next, start a local development server on [http://localhost:8000](http://localhost:8000){target=_blank}.

```shell linenums="1"
./task docs:serve
```

Next, open the docs in your browser.

```shell linenums="1"
./task docs:open
```

## Autogenerated Markdown

Some Markdown files are autogenerated, e.g., [Dependencies](../dependencies.md){target=_blank} or [Interface](../interface.md){target=_blank}.
Changes must be made in the respective template files.
Files are generated during the Release workflow and overwrite committed files.
To warn the developer, include the following custom marco at the top of the template.

```text linenums="1"
{% raw %}
{{ autogenerated_notice('./task docs:generate:dependencies') }}
{% endraw %}
```

This will render the following warning, if the docs are served using `./task docs:serve` but not when built.

{{ autogenerated_notice('./task docs:generate:dependencies', True) }}


## Casts

{{ linux_only_notice() }}

The docs contain recorded demos.
We use the following tools.

- [asciinema](https://asciinema.org/){target=_blank} to record a terminal session.
- [demo-magic](https://github.com/paxtonhare/demo-magic){target=_blank} to automate the terminal session.
- [asciinema-player](https://github.com/asciinema/asciinema-player){target=_blank} to embed casts in a standalone manner.

Casts are not recorded during any workflow.
The following command can be used to record the `home` cast for the landing page.

```shell linenums="1"
./task docs:record:home
```

A cast can be embedded using the custom macro `asciinema_player` inside a Markdown file.

```text linenums="1"
{% raw %}
{{ asciinema_player('getting-started') }}
{% endraw %}
```

This will embed the cast `docs/docs/assets/casts/getting-started.cast` inside the page as follows.

{{ asciinema_player('getting-started') }}


## Export 

{{ linux_only_notice() }}

To export _registered_ pages as PDF, run the following command. 
The PDFs are stored in `dist-docs`.

```shell linenums="1"
./task docs:export
```

By default, [https://vintner.opentosca.org](https://vintner.opentosca.org){target=_blank} is used.
To export pages of [http://localhost:8000](http://localhost:8000){target=_blank}, run the following command. 

```shell linenums="1"
./task docs:export:local
```


## Interface

To generate the documentation for the CLI and REST API, run the following command.
This command is also executed during the Release workflow and overwrites committed files.

```shell linenums="1"
./task docs:generate:interface
```

## Dependencies

To generate a list of licenses for all (transitive) dependencies, run the following command
This command is also executed during the Release workflow and overwrites committed files.

```shell linenums="1"
./task docs:generate:dependencies
```

The list includes information, such as package name, version, license, etc., and is written to a CSV file.
At the same time, the [Dependencies](../dependencies.md){target=_blank} page is generated.

## Puccini

{{ linux_only_notice() }}

We use [puccini](https://github.com/tliron/puccini) to validate a service template.
Therefore, run the following command.

```shell linenums="1"
./task puccini:check:single path/to/service-template.yaml
```

To validate all registered service templates, run the following command.

```shell linenums="1"
./task puccini:check
```

## PlantUML

We use [PlantUML](http://plantuml.com) for visualizing UML diagrams.
Read [PlantUML Guide](https://plantuml.com/de/guide) for modeling instructions.
We use [mkdocs_build_plantuml](https://github.com/quantorconsulting/mkdocs_build_plantuml){target=_blank} to plot PlantUML to SVGs when building the documentation.
Note, we use the public PlantUML server [https://www.plantuml.com/plantuml](https://www.plantuml.com/plantuml){target=_blank} for plotting SVGs.

## Queries4TOSCA

To generate the conformance tests for Queries4TOSCA, run the following command.
This command is also executed during the Release workflow and overwrites committed files.

```shell linenums="1"
./task docs:generate:query
```

## TOSCA SofDCar Profile

To generate the TOSCA SofDCar Profile, run the following command.
This command is also executed during the Release workflow and overwrites committed files.

```shell linenums="1"
./task docs:generate:query
```

## Variability4TOSCA

To generate the conformance tests for Variability4TOSCA, run the following command.
This command is also executed during the Release workflow and overwrites committed files.

```shell linenums="1"
./task docs:generate:query
```


## Limitations

- Performance is suffering due to the heavy use of plugins.
- It is not possible to configure which release should be shown in the navigation bar. The latest release is always use which is in general correct.
