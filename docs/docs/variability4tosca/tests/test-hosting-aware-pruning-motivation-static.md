# hosting-aware-pruning-motivation-static

{{ autogenerated_notice('./task docs:generate:tests:variability') }}

## Description

- 2 conditions at shop hosting relations
- required to trigger incoming pruning
- alternative is to model 2 conditions at the direct hosts   

- 2 conditions at shop database connections
- required, since database must be pruned
- alternative is to model 2 conditions at the databases directly

- 1 condition at monitor
- required, since incoming pruning of monitor host is not triggered

- 5 conditions in total

- required_hosting_constraint has no effect
- optimization has no effect


## Variable Service Template

The variability of the following variable service template shall be resolved.

```yaml linenums="1"
{% raw %}
tosca_definitions_version: tosca_variability_1_0
topology_template:
    variability:
        inputs:
            static:
                type: boolean
                default: true
        presets:
            static:
                inputs:
                    static: true
            elastic:
                inputs:
                    static: false
        expressions:
            is_static:
                equal:
                    - variability_input: static
                    - true
            is_elastic:
                equal:
                    - variability_input: static
                    - false
        options:
            mode: semantic-loose
            node_default_condition_mode: incoming
            required_hosting_constraint: false
            optimization_topology: false
            optimization_topology_unique_backward: true
    node_templates:
        shop:
            type: shop.component
            anchor: true
            requirements:
                - host:
                      node: os_compute
                      conditions:
                          logic_expression: is_static
                - host:
                      node: gcp_runtime
                      conditions:
                          logic_expression: is_elastic
                - database:
                      node: os_database
                      conditions:
                          logic_expression: is_static
                - database:
                      node: gcp_database
                      conditions:
                          logic_expression: is_elastic
        os_database:
            type: os.database
            requirements:
                - host: os_compute
        os_monitor:
            type: os.monitor
            conditions:
                logic_expression: is_static
            requirements:
                - host: os_compute
        os_compute:
            type: os.compute
            requirements:
                - host: os_cloud
        os_cloud:
            type: os.provider
        gcp_runtime:
            type: gcp.runtime
            requirements:
                - host: gcp_cloud
        gcp_database:
            type: gcp.database
            requirements:
                - host: gcp_dbms
        gcp_dbms:
            type: gcp.dbms
            requirements:
                - host: gcp_cloud
        gcp_cloud:
            type: gcp.provider
{% endraw %}
```




## Variability-Resolved Service Template

The following variability-resolved service template is expected.

```yaml linenums="1"
{% raw %}
tosca_definitions_version: tosca_simple_yaml_1_3
topology_template:
    node_templates:
        shop:
            type: shop.component
            requirements:
                - host: os_compute
                - database: os_database
        os_database:
            type: os.database
            requirements:
                - host: os_compute
        os_monitor:
            type: os.monitor
            requirements:
                - host: os_compute
        os_compute:
            type: os.compute
            requirements:
                - host: os_cloud
        os_cloud:
            type: os.provider
{% endraw %}
```

